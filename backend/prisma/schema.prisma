// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url = env("POSTGRES_URL_ONLINE")
}

enum Role {
  user
  admin
}

model Users {
  id             String    @id @default(uuid())
  name           String
  email          String    @unique
  passwordHashed String?   // null gdy OAuth
  provider       String    @default("local")
  providerId     String?   @unique

  role           Role @default(user)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  characters     Characters[]
  campaigns      Campaign[]
}

model Characters {
  id           String  @id @default(uuid())
  name         String
  race         String
  class        String
  level        Int

  stats Json 
  saves Json 
  skills Json 
  proficiencies Json
  background    String
  alignment     String
  xp            Int
  armorPoints   Int
  initiative    Int
  speed         Int
  hp            Int
  hpMax         Int
  size          String
  inspiration   Boolean
  deathSavesSuccess Int
  deathSavesFail    Int
  racialAbilities   Json
  passivePerception Int
  equipment         Json
  money             Int
  magicSkill        Int
  magicBonus        Int
  magicDC           Int
  knownSpells       Json
  preparedSpells    Json
  spellSlots        Json

  owner   Users @relation(fields: [ownerId], references: [id])
  ownerId String

  campaign Campaign? @relation(fields: [campaignId], references: [id])
  campaignId String?

}

model Campaign {
  id     String @id @default(uuid())
  name   String
  description String
  joinCode String

  owner   Users   @relation(fields: [ownerId], references: [id])
  ownerId String

  characters Characters[]
  missions Mission[]
  notes Note[]
  maps Map[]
  locations Location[]
  npcs NPC[]
}


model Mission {
  id     String @id @default(uuid())
  title  String
  description String
  status Boolean

  campaign   Campaign @relation(fields: [campaignId], references: [id])
  campaignId String
}

model Note {
  id     String @id @default(uuid())
  name   String
  description String
  author String
  date   DateTime

  campaign   Campaign @relation(fields: [campaignId], references: [id])
  campaignId String
}

model Map {
  id     String @id @default(uuid())
  file   String
  name   String
  description String

  campaign   Campaign @relation(fields: [campaignId], references: [id])
  campaignId String
}


model Location {
  id     String @id @default(uuid())
  name   String
  description String

  campaign   Campaign @relation(fields: [campaignId], references: [id])
  campaignId String
}


model NPC {
  id     String @id @default(uuid())
  name   String
  description String

  campaign   Campaign @relation(fields: [campaignId], references: [id])
  campaignId String
}


